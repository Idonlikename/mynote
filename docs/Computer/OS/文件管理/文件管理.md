# 文件管理系统



### RAID—磁盘阵列

RAID全称为**`Redundant Array of Independent Disks`**，中文为**独立磁盘冗余阵列**。

其为一种将多个硬盘驱动器组成一个逻辑单元的数据存储虚拟化技术，以提高容量，读写速度以及数据可靠性。

#### RAID0

RAID0 是一种追求**极致容量和读写速度**的磁盘阵列。其的实现原理是将**多个磁盘均用于读写和存储**，一个数据被拆分成多个数据写入磁盘阵列当中。

优势：n个磁盘均用于读写，所以**读写速度为单个硬盘的n倍**；同时因为数据被拆分n份写入，**容量也达到单个硬盘的n倍**。

弊端：因为一个数据的某个bit位都只存于一个盘中，所以只要一个盘损坏数据将无法复原。**数据可靠性极低**



#### RAID1

RAID1 是一种追求**极致的可靠性**的阵列。其原理是**多个硬盘用于读取同一个文件**，起到多重备份的作用。

优势：多个文件读取同一个文件（完整读取），所以尽管有多个磁盘损坏，仍能恢复数据，**可靠性高**

弊端：多个文件都读取同样的数据，所以**容量和读写速度仍是一个磁盘的规格**



#### RAID10

RAID10并非一个全新的独立阵列，而是**基于RAID1和RAID0的的阵列方式**。其实现原理是**先RAID1再RAID0**（所以实际是存在RAID01的，也就是先0再1）。其实现的原理是将n个磁盘拆分个m份，用于实现RAID1阵列，这m个阵列中都至少有2磁盘；再将这m个阵列，又再一次组成一个RAID0阵列。

优劣：并没有很明显的优劣，相较于RAID0，对于每一个拆分后的数据都有备份。相较于RAID1每一个数据都已经进行拆分，所以存储数据的容量和速度均有m倍的提升

> Q：为什么不使用RAID01呢？
>
> A：因为RAID01是先使用RAID0组成阵列，再用这些阵列组成RAID1阵列。这样的话，当我们想对设备进行升级的时候即对于容量和读写速度提升。就需要对每个RAID0阵列都添加至少一个盘（而且每个阵列添加的盘应该相同），而不能像RAID10一样只需要添加一个阵列（甚至这个阵列中仅有两个磁盘）。

#### 不常用RAID

RAID2/3/4 均是针对不同的场景设计的阵列方案，因而在实际使用时会具有很大的缺陷。所以很少使用

##### RAID2

最少需要3个磁盘。读写的时候需要对数据进行实时编码，分段写入不同的硬盘。得到的数据比原始数据大，RAID2模式在读写时需要实时校验数据。使用的校验算法比较复杂，硬件开销大。

##### RAID3

RAID3是在RAID2的基础上发展而来的，采用的算法更为简单。RAID3也需要三个磁盘，两个用于分段写入数据，而一个盘用于存储校验数据。（由于进行读写操作的时候都会访问校验盘，这使得校验盘极易长时间高负载工作），校验盘如果损坏所有数据丢失。

##### RAID4

RAID4同样采用，一个盘用于校验盘用，不同的是RAID3采用`bit`分割存储数据，而RAID4则用**数据块（数据块大小由系统决定）**分割存储数据。因为数据块比bit位大的缘故，小文件的写入RAID4更快。RAID4相较于RAID3非校验盘损坏恢复的概率更低。

### 常用RAID

#### RAID5

多硬盘并联，其中一个盘的容量用于存储校验数据。RAID5的原理和RAID3原理类似，同样至少需要3个磁盘，但是RAID5将校验的数据分散在每一个盘中，如果一个盘的数据损坏，可依靠其他盘中的数据配合校验信息恢复。RAID5读写速度与RAID0相近，但不及RAID0；因为各个盘中会占据一个盘的校验数据，所以可用容量=总容量-单个磁盘的容量（每个盘大小一致）。

#### RAID6

多硬盘并联，其中两个盘的容量存储校验数据。因为需要两个盘的容量存放存储校验信息，RAID6则至少需要4块硬盘。原理上和RAID5类似。RAID6会使用两种不同的校验算法，任意坏两个盘都能够实现数据恢复，所以RAID6数据安全性非常高。相较于RAID5，因为比RAID5多使用一种校验算法，校验数据量比RAID5大，计算量也比RAID5大，所以读写速度不如RAID5。

### URE

URE指的是硬盘先天缺陷，机械硬盘无法避免不可恢复性读取错误。也就是在读取一定量的数据时，盘可能出现一个无法读取的错误。（大概是每12T可能读取1个）。因为这个缺陷，所以RAID6比RAID5更安全一点。解释：当RAID5出现这个错误，RAID5就需要重新建立阵列，导致所有的盘都在长期高负荷工作，很容易出现恢复过程中其他盘损坏进而导致数据无法恢复。RAID6还有错一个的容错

